<template>
  <div class="page" style="flex-direction: column;" @touchstart="onTouchStart" @touchmove="onTouchMove" @touchend="onTouchEnd">
    <img static src="/common/images/hd.png" style="position: absolute;left: 0px;top: 0px;width: 432px;height: 102px;" />
    <img static src="/common/images/back.png" @click="exit" style="position: absolute;left: 38px;top: 24px;width: 82px;height: 82px;"/>
    <img static src="/common/images/more.png" @click="openSettings" style="position: absolute;left: 322px;top: 24px;width: 82px;height: 82px;"/>
    <text style="position: absolute;left: 130px;top: 16px;width: 172px;line-height: 32px;font-weight:bold;font-size:24px;color:rgba(255,255,255,0.6);text-align:center;">
      {{nowTime}}
    </text>
    <text static style="position: absolute;left: 130px;top: 46px;width: 172px;line-height: 42px;font-weight:bold;font-size:32px;color:white;text-align:center;">
      计算器
    </text>

    <div class="display">
      <text class="display-text">{{display}}</text>
    </div>

    <div class="keys">
      <div class="row" if="!isSci">
        <div class="key soft" clickable="true" @click="pressClear"><text class="key-label">{{clearLabel}}</text></div>
        <div class="key soft" clickable="true" @click="pressBackspace"><text class="key-label">←</text></div>
        <div class="key soft" clickable="true" @click="pressPercent"><text class="key-label">%</text></div>
        <div class="key op" clickable="true" @click="pressOp('÷')"><text class="key-label">÷</text></div>
      </div>
      <div class="row" if="!isSci">
        <div class="key" clickable="true" @click="pressDigit('7')"><text class="key-label">7</text></div>
        <div class="key" clickable="true" @click="pressDigit('8')"><text class="key-label">8</text></div>
        <div class="key" clickable="true" @click="pressDigit('9')"><text class="key-label">9</text></div>
        <div class="key op" clickable="true" @click="pressOp('×')"><text class="key-label">×</text></div>
      </div>
      <div class="row" if="!isSci">
        <div class="key" clickable="true" @click="pressDigit('4')"><text class="key-label">4</text></div>
        <div class="key" clickable="true" @click="pressDigit('5')"><text class="key-label">5</text></div>
        <div class="key" clickable="true" @click="pressDigit('6')"><text class="key-label">6</text></div>
        <div class="key op" clickable="true" @click="pressOp('−')"><text class="key-label">−</text></div>
      </div>
      <div class="row" if="!isSci">
        <div class="key" clickable="true" @click="pressDigit('1')"><text class="key-label">1</text></div>
        <div class="key" clickable="true" @click="pressDigit('2')"><text class="key-label">2</text></div>
        <div class="key" clickable="true" @click="pressDigit('3')"><text class="key-label">3</text></div>
        <div class="key op" clickable="true" @click="pressOp('＋')"><text class="key-label">＋</text></div>
      </div>
      <div class="row" if="!isSci">
        <div class="key" clickable="true" @click="pressToggleSci"><text class="key-label">科学</text></div>
        <div class="key" clickable="true" @click="pressDigit('0')"><text class="key-label">0</text></div>
        <div class="key" clickable="true" @click="pressDot"><text class="key-label">.</text></div>
        <div class="key eq" clickable="true" @click="pressEquals"><text class="key-label">＝</text></div>
      </div>

      <!-- Scientific keypad -->
      <div class="row" if="isSci">
        <div class="key" clickable="true" @click="pressConst('e')"><text class="key-label">e</text></div>
        <div class="key" clickable="true" @click="pressConst('pi')"><text class="key-label">π</text></div>
        <div class="key" clickable="true" @click="pressFunc('√')"><text class="key-label">√</text></div>
        <div class="key" clickable="true" @click="pressHelp"><text class="key-label">?</text></div>
      </div>
      <div class="row" if="isSci">
        <div class="key" clickable="true" @click="pressFunc('sin')"><text class="key-label">sin</text></div>
        <div class="key" clickable="true" @click="pressFunc('cos')"><text class="key-label">cos</text></div>
        <div class="key" clickable="true" @click="pressFunc('tan')"><text class="key-label">tan</text></div>
        <div class="key" clickable="true" @click="pressFunc('lg')"><text class="key-label">lg</text></div>
      </div>
      <div class="row" if="isSci">
        <div class="key" clickable="true" @click="pressFunc('asin')"><text class="key-label">asin</text></div>
        <div class="key" clickable="true" @click="pressFunc('acos')"><text class="key-label">acos</text></div>
        <div class="key" clickable="true" @click="pressFunc('atan')"><text class="key-label">atan</text></div>
        <div class="key" clickable="true" @click="pressFunc('ln')"><text class="key-label">ln</text></div>
      </div>
      <div class="row" if="isSci">
        <div class="key" clickable="true" @click="pressFunc('sinh')"><text class="key-label">sinh</text></div>
        <div class="key" clickable="true" @click="pressFunc('cosh')"><text class="key-label">cosh</text></div>
        <div class="key" clickable="true" @click="pressFunc('tanh')"><text class="key-label">tanh</text></div>
        <div class="key" clickable="true" @click="pressFunc('asinh')"><text class="key-label">asinh</text></div>
      </div>
      <div class="row" if="isSci">
        <div class="key" clickable="true" @click="toggleAngle"><text class="key-label">{{degMode ? 'DEG' : 'RAD'}}</text></div>
        <div class="key" clickable="true" @click="pressHelp"><text class="key-label">?</text></div>
        <div class="key" style="opacity:0"><text class="key-label">&nbsp;</text></div>
        <div class="key" style="opacity:0"><text class="key-label">&nbsp;</text></div>
      </div>
      <div class="row" if="isSci">
        <div class="key" clickable="true" @click="pressFunc('acosh')"><text class="key-label">acosh</text></div>
        <div class="key" clickable="true" @click="pressFunc('atanh')"><text class="key-label">atanh</text></div>
        <div class="key" clickable="true" @click="pressPow"><text class="key-label">^</text></div>
        <div class="key" clickable="true" @click="pressFactorial"><text class="key-label">!</text></div>
      </div>
      <div class="row" if="isSci">
        <div class="key" clickable="true" @click="pressToggleSci"><text class="key-label">普通</text></div>
        <div class="key" clickable="true" @click="pressParen('(')"><text class="key-label">(</text></div>
        <div class="key" clickable="true" @click="pressParen(')')"><text class="key-label">)</text></div>
        <div class="key soft" clickable="true" @click="pressBackspace"><text class="key-label">←</text></div>
      </div>
    </div>
  </div>
  
</template>

<script>
import router from '@system.router'
import vibrator from '@system.vibrator'
import storage from '../../common/storage.js'
import { KEYS } from '../../common/keys.js'
const Mexp = require('math-expression-evaluator')

export default {
  private: {
    nowTime: '00:00',
    unsubscribeTick: null,
    timer: null,
    timeFormat: '24h',
    display: '0',
    current: '',
    hasDot: false,
    tokens: [], // sequence of [number, op, number, ...]
    plusCount: 0,
    lastPlusTs: 0,
    _memoryClipboard: '',
    isSci: false,
    clearLabel: 'AC',
    swipeStartX: null,
    swipeEndX: null,
    vibrateEnabled: true,
    degMode: false
  },
  openSettings() {
    this.onVibrate();
    router.push({ uri: '/pages/calculatorSetting' });
  },
  exit() {
    this.onVibrate();
    try { router.back(); } catch (e) {}
  },
  onInit() {
    this.updateTime();
    this.timer = setInterval(() => this.updateTime(), 1000);
    this.updateClearLabel();
    // 读取震动开关
    storage.get({
      key: KEYS.VIBRATE_ENABLED,
      success: (data) => {
        if (typeof data !== 'undefined') {
          this.vibrateEnabled = data === 'true';
        }
      }
    });
  },
  updateTime() {
    const d = new Date();
    let h = d.getHours();
    let m = d.getMinutes();
    if (this.timeFormat === '12h') {
      const ampm = h >= 12 ? '下午' : '上午';
      h = h % 12;
      h = h ? h : 12;
      m = m < 10 ? ('0' + m) : m;
      this.nowTime = `${ampm} ${h}:${m}`;
    } else {
      const hh = h < 10 ? ('0' + h) : h;
      const mm = m < 10 ? ('0' + m) : m;
      this.nowTime = `${hh}:${mm}`;
    }
  },
  onShow() {
    // 返回页面时刷新震动开关状态
    storage.get({
      key: KEYS.VIBRATE_ENABLED,
      success: (data) => {
        if (typeof data !== 'undefined') {
          this.vibrateEnabled = data === 'true';
        }
      }
    });
  },
  updateClearLabel() {
    // 固定为 AC，不再根据输入状态切换为 C
    this.clearLabel = 'AC';
  },
  onVibrate(mode = 'short') {
    if (!this.vibrateEnabled) return;
    try {
      if (vibrator && typeof vibrator.vibrate === 'function') {
        vibrator.vibrate({ mode });
      }
    } catch (e) {}
  },
  pressToggleSci() {
    this.onVibrate();
    this.isSci = !this.isSci;
  },
  onTouchStart(e) {
    if (!e || !e.touches || !e.touches[0]) return;
    this.swipeStartX = e.touches[0].clientX;
    this.swipeEndX = this.swipeStartX;
  },
  onTouchMove(e) {
    if (!e || !e.touches || !e.touches[0]) return;
    this.swipeEndX = e.touches[0].clientX;
  },
  onTouchEnd(e) {
    if (this.swipeStartX === null) return;
    const deltaX = this.swipeEndX - this.swipeStartX;
    this.swipeStartX = null;
    this.swipeEndX = null;
    if (deltaX > 60) {
      router.push({ uri: '/pages/about_calculator' });
    }
  },
  pressConst(name) {
    this.onVibrate();
    const val = name === 'pi' ? Math.PI : Math.E;
    // if currently entering, replace current
    this.current = String(val);
    this.hasDot = true;
    this.display = this.formatTokensForDisplay(true);
    this.updateClearLabel();
  },
  pressFunc(name) {
    this.onVibrate();
    // push function and opening bracket, user will input argument then press ) or =
    if (this.current !== '' && this.current !== null) {
      const num = parseFloat(this.current);
      if (!Number.isNaN(num)) this.tokens.push(num);
      this.current = '';
      this.hasDot = false;
    }
    this.tokens.push(name);
    this.tokens.push('(');
    this.display = this.formatTokensForDisplay();
    this.updateClearLabel();
  },
  pressParen(ch) {
    this.onVibrate();
    if (this.current !== '' && this.current !== null) {
      const num = parseFloat(this.current);
      if (!Number.isNaN(num)) this.tokens.push(num);
      this.current = '';
      this.hasDot = false;
    }
    this.tokens.push(ch);
    this.display = this.formatTokensForDisplay();
    this.updateClearLabel();
  },
  onDestroy() {
    if (this.timer) { try { clearInterval(this.timer); } catch (e) {} this.timer = null }
  },
  pressDigit(d) {
    this.onVibrate();
    if (this.current === '0') {
      this.current = d;
    } else {
      this.current = (this.current || '') + d;
    }
    this.display = this.formatTokensForDisplay(true);
    this.updateClearLabel();
  },
  pressDot() {
    this.onVibrate();
    if (this.hasDot) return;
    if (!this.current) this.current = '0';
    this.current += '.';
    this.hasDot = true;
    this.display = this.formatTokensForDisplay(true);
    this.updateClearLabel();
  },
  pressOp(op) {
    this.onVibrate();
    // secret entry: 5-plus presses within 10 seconds
    if (op === '＋') {
      const now = Date.now();
      if (now - this.lastPlusTs <= 10000) {
        this.plusCount += 1;
      } else {
        this.plusCount = 1;
      }
      this.lastPlusTs = now;
      if (this.plusCount >= 5) {
        router.push({ uri: '/pages/index' });
        this.plusCount = 0;
        this.lastPlusTs = 0;
      }
    } else {
      this.plusCount = 0;
      this.lastPlusTs = 0;
    }

    // ensure starting from 0 when no input yet, so display shows 0+op
    let insertedZero = false;
    if ((this.current === '' || this.current === null) && this.tokens.length === 0) {
      this.tokens.push(0);
      insertedZero = true;
    }
    // push current number if present
    if (this.current !== '' && this.current !== null) {
      const num = parseFloat(this.current);
      if (!Number.isNaN(num)) this.tokens.push(num);
      this.current = '';
      this.hasDot = false;
    }
    // if last token is operator, replace it; do not replace brackets or function names
    if (this.tokens.length > 0 && typeof this.tokens[this.tokens.length - 1] === 'string') {
      const lastTok = this.tokens[this.tokens.length - 1];
      const isOperator = lastTok === '＋' || lastTok === '−' || lastTok === '×' || lastTok === '÷' || lastTok === '^';
      if (isOperator) {
        this.tokens[this.tokens.length - 1] = op;
      } else {
        this.tokens.push(op);
      }
    } else {
      this.tokens.push(op);
    }
    this.display = this.formatTokensForDisplay();
    if (!insertedZero) {
      this.updateClearLabel();
    }
  },
  pressEquals() {
    this.onVibrate();
    // finalize tokens with current
    if (this.current !== '' && this.current !== null) {
      const num = parseFloat(this.current);
      if (!Number.isNaN(num)) this.tokens.push(num);
      this.current = '';
      this.hasDot = false;
    }
    // auto-close unmatched brackets
    let balance = 0;
    for (const t of this.tokens) {
      if (t === '(') balance++;
      else if (t === ')') balance--;
    }
    while (balance > 0) { this.tokens.push(')'); balance--; }
    // trim trailing operator only
    if (this.tokens.length > 0) {
      const last = this.tokens[this.tokens.length - 1];
      if (typeof last === 'string' && (last === '＋' || last === '−' || last === '×' || last === '÷' || last === '^' || last === '!')) {
        this.tokens.pop();
      }
    }
    const exprString = this.formatTokensForDisplay(false);
    const result = this.evaluateTokens(this.tokens);
    if (result === null || !isFinite(result)) {
      this.display = '错误';
      this.tokens = [];
      return;
    }
    this.recordHistory(exprString, this.formatNumber(result));
    this.display = this.formatNumber(result);
    this.tokens = [result];
    this.updateClearLabel();
  },
  toggleAngle() {
    this.onVibrate();
    this.degMode = !this.degMode;
  },
  pressPow() {
    this.pressOp('^');
  },
  pressFactorial() {
    this.onVibrate();
    if (this.current !== '' && this.current !== null) {
      const num = parseFloat(this.current);
      if (!Number.isNaN(num)) this.tokens.push(num);
      this.current = '';
      this.hasDot = false;
    }
    this.tokens.push('!');
    this.display = this.formatTokensForDisplay();
    this.updateClearLabel();
  },
  pressClear() {
    this.onVibrate();
    this.tokens = [];
    this.current = '';
    this.hasDot = false;
    this.display = '0';
    this.updateClearLabel();
  },
  pressBackspace() {
    this.onVibrate();
    if (!this.current) return;
    const last = this.current.slice(-1);
    this.current = this.current.slice(0, -1);
    if (last === '.') this.hasDot = false;
    if (this.current === '' || this.current === '-') {
      this.display = this.formatTokensForDisplay();
    } else {
      this.display = this.formatTokensForDisplay(true);
    }
    this.updateClearLabel();
  },
  pressSign() {
    this.onVibrate();
    if (!this.current || this.current === '0') {
      // toggle sign on zero results in -0 visually
      this.current = this.current === '0' ? '-0' : '-0';
    } else if (this.current.startsWith('-')) {
      this.current = this.current.substring(1);
    } else {
      this.current = '-' + this.current;
    }
    this.display = this.formatTokensForDisplay(true);
  },
  pressPercent() {
    this.onVibrate();
    // Apply percent to current number if present, otherwise to the last numeric token
    const applyPercent = (val) => {
      const n = parseFloat(val);
      if (Number.isNaN(n)) return null;
      return n / 100;
    };
    if (this.current !== '' && this.current !== null) {
      const n = applyPercent(this.current);
      if (n !== null) {
        this.current = this.formatNumber(n);
        this.display = this.formatTokensForDisplay(true);
      }
      return;
    }
    for (let i = this.tokens.length - 1; i >= 0; i--) {
      if (typeof this.tokens[i] === 'number') {
        const n = applyPercent(this.tokens[i]);
        if (n !== null) {
          this.tokens[i] = n;
          this.display = this.formatTokensForDisplay();
        }
        this.updateClearLabel();
        break;
      }
    }
  },
  pressCopy() {
    const text = String(this.display || '');
    let copied = false;
    try {
      const pasteboard = require('@system.pasteboard');
      if (pasteboard && pasteboard.setText) {
        pasteboard.setText({ text });
        copied = true;
      }
    } catch (e) {}
    if (!copied) {
      try {
        const clipboard = require('@system.clipboard');
        if (clipboard && clipboard.set) {
          clipboard.set({ text });
          copied = true;
        }
      } catch (e2) {}
    }
    if (!copied) {
      this._memoryClipboard = text;
    }
  },
  formatTokensForDisplay(includeCurrent = false) {
    let out = '';
    for (const t of this.tokens) {
      if (typeof t === 'number') {
        out += this.formatNumber(t);
      } else {
        // Show operators and parentheses without extra spaces
        out += t;
      }
    }
    if (includeCurrent && this.current !== '' && this.current !== null) {
      out += this.current;
    }
    return out || '0';
  },
  formatNumber(n) {
    const s = n.toString();
    // limit to 12 chars if too long
    if (s.length > 12) return Number(n.toFixed(8)).toString();
    return s;
  },
  recordHistory(expr, res) {
    try {
      storage.get({
        key: KEYS.CALC_HISTORY,
        success: (data) => {
          let list = [];
          if (Array.isArray(data)) list = data; else if (typeof data === 'string' && data) {
            try { list = JSON.parse(data); } catch (e) { list = []; }
          }
          list.unshift({ expr, res, ts: Date.now() });
          if (list.length > 50) list = list.slice(0, 50);
          storage.set({ key: KEYS.CALC_HISTORY, value: list });
        }
      });
    } catch (e) {}
  },
  evaluateTokens(tokens) {
    if (!tokens || tokens.length === 0) return 0;
    const mapOps = { '＋': '+', '−': '-', '×': '*', '÷': '/' };
    const funcSet = new Set(['sin','cos','tan','asin','acos','atan','sinh','cosh','tanh','asinh','acosh','atanh','√','log','ln','lg']);
    let expr = '';
    for (let i = 0; i < tokens.length; i++) {
      const t = tokens[i];
      const prev = i > 0 ? tokens[i - 1] : null;
      const prevIsValue = typeof prev === 'number' || prev === ')';
      const currIsFunc = typeof t === 'string' && funcSet.has(t);
      const currIsLParen = t === '(';
      const currIsNumber = typeof t === 'number';
      if (i > 0) {
        if (prevIsValue && (currIsFunc || currIsLParen || currIsNumber)) {
          expr += '*';
        }
      }
      if (typeof t === 'number') expr += String(t);
      else if (mapOps[t]) expr += mapOps[t];
      else if (t === '√') expr += 'sqrt';
      else expr += t;
    }
    function wrapArg(src, fn, mul) {
      let out = '';
      for (let i = 0; i < src.length; ) {
        if (src.startsWith(fn + '(', i)) {
          let j = i + fn.length + 1, depth = 1;
          while (j < src.length && depth > 0) {
            const ch = src[j];
            if (ch === '(') depth++;
            else if (ch === ')') depth--;
            j++;
          }
          const inner = src.substring(i + fn.length + 1, j - 1);
          out += fn + '(' + '(' + inner + ')*' + mul + ')';
          i = j;
        } else { out += src[i]; i++; }
      }
      return out;
    }
    function replaceFn(src, fn, builder) {
      let out = '';
      for (let i = 0; i < src.length; ) {
        if (src.startsWith(fn + '(', i)) {
          let j = i + fn.length + 1, depth = 1;
          while (j < src.length && depth > 0) {
            const ch = src[j];
            if (ch === '(') depth++;
            else if (ch === ')') depth--;
            j++;
          }
          const inner = src.substring(i + fn.length + 1, j - 1);
          out += builder(inner);
          i = j;
        } else { out += src[i]; i++; }
      }
      return out;
    }
    const PI = '3.141592653589793';
    // natural log
    expr = replaceFn(expr, 'ln', (inner) => 'log(' + inner + ')');
    // base-10 log via natural log
    expr = replaceFn(expr, 'lg', (inner) => '(log(' + inner + '))/log(10)');
    // hyperbolic (use natural log for inverses mapped to log)
    expr = replaceFn(expr, 'sinh', (inner) => '((exp(' + inner + ')-exp(-(' + inner + ')))/2)');
    expr = replaceFn(expr, 'cosh', (inner) => '((exp(' + inner + ')+exp(-(' + inner + ')))/2)');
    expr = replaceFn(expr, 'tanh', (inner) => '((exp(' + inner + ')-exp(-(' + inner + ')))/(exp(' + inner + ')+exp(-(' + inner + '))))');
    expr = replaceFn(expr, 'asinh', (inner) => 'log((' + inner + ')+sqrt((' + inner + ')*(' + inner + ')+1))');
    expr = replaceFn(expr, 'acosh', (inner) => 'log((' + inner + ')+sqrt((' + inner + ')*(' + inner + ')-1))');
    expr = replaceFn(expr, 'atanh', (inner) => '((1/2)*log((1+(' + inner + '))/(1-(' + inner + '))))');
    if (this.degMode) {
      expr = wrapArg(expr, 'sin', PI + '/180');
      expr = wrapArg(expr, 'cos', PI + '/180');
      expr = wrapArg(expr, 'tan', PI + '/180');
      expr = replaceFn(expr, 'asin', (inner) => '(asin(' + inner + '))*180/' + PI);
      expr = replaceFn(expr, 'acos', (inner) => '(acos(' + inner + '))*180/' + PI);
      expr = replaceFn(expr, 'atan', (inner) => '(atan(' + inner + '))*180/' + PI);
    }
    try {
      const v = Mexp.eval(expr);
      return (typeof v === 'number' && isFinite(v)) ? v : null;
    } catch (e) {
      const alt = this.basicEval(tokens);
      return (typeof alt === 'number' && isFinite(alt)) ? alt : null;
    }
  }
  ,basicEval(tokens) {
    const prec = { '＋': 1, '−': 1, '×': 2, '÷': 2, '^': 3 };
    const isOp = (x) => x === '＋' || x === '−' || x === '×' || x === '÷' || x === '^';
    const ops = [];
    const out = [];
    for (const t of tokens) {
      if (typeof t === 'number') {
        out.push(t);
      } else if (t === '(') {
        ops.push(t);
      } else if (t === ')') {
        while (ops.length && ops[ops.length - 1] !== '(') {
          out.push(ops.pop());
        }
        if (ops.length && ops[ops.length - 1] === '(') ops.pop();
      } else if (isOp(t)) {
        while (ops.length && isOp(ops[ops.length - 1]) && prec[ops[ops.length - 1]] >= prec[t]) {
          out.push(ops.pop());
        }
        ops.push(t);
      } else {
        return null;
      }
    }
    while (ops.length) {
      if (ops[ops.length - 1] === '(') return null;
      out.push(ops.pop());
    }
    const st = [];
    for (const t of out) {
      if (typeof t === 'number') {
        st.push(t);
      } else if (isOp(t)) {
        const b = st.pop();
        const a = st.pop();
        if (!isFinite(a) || !isFinite(b)) return null;
        switch (t) {
          case '＋': st.push(a + b); break;
          case '−': st.push(a - b); break;
          case '×': st.push(a * b); break;
          case '÷': st.push(b === 0 ? NaN : a / b); break;
          case '^': st.push(Math.pow(a, b)); break;
        }
      } else {
        return null;
      }
    }
    const res = st.pop();
    return (res === undefined || Number.isNaN(res)) ? null : res;
  }
}
</script>

<style>
.page {
  width: 432px;
  height: 514px;
  background-color: #000000;
}
.display {
  position: absolute;
  top: 122px;
  left: 20px;
  width: 392px;
  height: 98px;
  background-color: #262626;
  border-radius: 24px;
  padding: 0 16px;
  justify-content: flex-end;
  align-items: center;
}
.display-text {
  font-size: 40px;
  font-weight: bold;
  color: white;
  text-overflow: ellipsis;
  lines: 1;
  width: 100%;
  text-align: right;
}
.keys {
  position: absolute;
  top: 236px;
  left: 20px;
  width: 392px;
  height: 260px;
  flex-direction: column;
  justify-content: space-between;
}
.row {
  width: 100%;
  height: 48px;
  flex-direction: row;
  justify-content: space-between;
}
.key {
  width: 88px;
  height: 48px;
  background-color: #000000;
  border-radius: 24px;
  font-size: 28px;
  font-weight: bold;
  align-items: center;
  justify-content: center;
}
.key-label { color: white; font-size: 30px; font-weight: bold; }
.key-icon { width: 32px; height: 32px; }
.key.wide { width: 184px; }
.key.op { background-color: #000000; }
.key.eq { background-color: #FF7A00; }
.key.soft { background-color: #000000; color: rgba(255,255,255,0.9); }
</style>